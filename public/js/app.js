function processAjaxErrors(t,a){if("object"==typeof t.responseJSON){var e=t.responseJSON;if("string"==typeof e.error)return void alert('Sorry, an error occurred\n\n"'+e.error+'"');if("object"==typeof a)return void a.find("input,textarea,select").each(function(){var t=$(this),a=t.parents(".form-group");t.attr("name")in e?(a.addClass("has-error"),$('<p class="help-block errormsg">'+e[t.attr("name")][0]+"</p>").insertAfter(t.parent().hasClass("input-group")?t.parent():t)):a.addClass("has-success")})}alert("Oops, an unknown error has occurred"),console.log(t.responseText)}function datetimepicker(t,a){var e=t.data("dateFormat")?t.data("dateFormat"):"YYYY-MM-DD",o=t.parent(),r={format:e,icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"fa fa-bullseye",clear:"fa fa-trash",close:"fa fa-remove"}};"object"==typeof a&&(r=$.extend({},r,a)),o.hasClass("input-group")?o.addClass("date").datetimepicker(r):t.datetimepicker(r)}!function(t){t.fn.extend({tabify:function(){return this.each(function(){var a=t(this);if(!a.hasClass("tab-group-perm")){var e=a.children("ul.nav-tabs").children("li"),o=a.children("div.tab-content").children("div.tab-pane");e.on("click",function(){if(!t(this).hasClass("active")){var a=e.index(t(this));e.removeClass("active"),o.removeClass("active"),e.eq(a).addClass("active"),o.eq(a).addClass("active")}return!1});var r=window.location.hash.substr(1);r&&e.filter("#"+r+"Tab").length?e.filter("#"+r+"Tab").eq(0).trigger("click"):e.filter(".active").length?e.filter(".active").eq(0).trigger("click"):e.eq(0).trigger("click")}})}})}(jQuery),function(t){var a=function(t){t.animate({opacity:"0"},100,function(){t.slideUp(100,function(){t.remove()})})};t.fn.CloseMessages=function(){var e=this.find("div.alert");e.each(function(){var e=t(this);if(e.hasClass("alert-perm")){var o=t('<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>');e.prepend(o)}else setTimeout(function(){a(e)},3e3)}),this.on("click","div.alert > button.close",function(){a(t(this).parent())})},jQuery(document).ready(function(){t("div#message-centre").CloseMessages()})}(jQuery),function(t){t.fn.DisableButtons=function(){this.each(function(){var a=t(this);a.on("click",function(t){a.addClass("disabled").off("click").on("click",function(){return!1}).children("span.fa").attr("class","").addClass("fa fa-refresh fa-spin").next().text(a.attr("disable-submit")||"Working ...")})})},jQuery(document).ready(function(){t("button[disable-submit]").DisableButtons()})}(jQuery);var $modal=$("#modal"),$modalDialog=$modal.children("div.modal-dialog"),$modalContent=$modalDialog.children("div.modal-content"),$form,$btns,$xhttp2="undefined"!=typeof FormData;!$xhttp2&&console&&console.log("ALERT: Your browser does not support XMLHttpRequest2. AJAX forms will work but you will be unable to upload files by AJAX."),function(t){function a(){return $modal.find("form")}function e(){return $modal.find("button")}$modal.on("show.bs.modal",function(e){var o=t(e.relatedTarget),r=t('div[data-type="modal-template"][data-id="'+o.data("modalTemplate")+'"]');if(r.length>0){$modalContent.html(r.html()),o.data("modalClass")&&$modalDialog.addClass(o.data("modalClass")),o.data("modalTitle")&&(0==$modalContent.children("div.modal-header").length&&$modalContent.prepend('<div class="modal-header"></div>'),$modalContent.children("div.modal-header").html("<h1>"+o.data("modalTitle")+"</h1>"));var n=o.data("formData");if("object"==typeof n){$form=a();var i;for(var l in n)i=$form.find('[name="'+l+'"]'),"checkbox"==i.attr("type")?i.prop("checked",!!n[l]):i.val(n[l])}$form=a(),$form.find('input[data-input-type="datetimepicker"]').each(function(a,e){datetimepicker(t(e))})}else $modal.one("shown.bs.modal",function(){$modal.modal("hide")})}),$modal.on("hidden.bs.modal",function(){$modalDialog.attr("class","modal-dialog"),$modalContent.html("")}),$modal.on("clearform",function(){$form=a(),$form.find(".has-error").removeClass("has-error").find("p.errormsg").remove(),$form.find(".has-success").removeClass("has-success")}),$modal.on("click",'[data-type="submit-modal"]',function(){(!t(this).data("submitConfirm")||confirm(t(this).data("submitConfirm")))&&$modal.trigger("ajaxsubmit",{btn:t(this)})}),$modal.on("ajaxsubmit",function(o,r){var n=r.btn;$form=a(),$btns=e(),$form.attr("action",n.data("formAction")),$btns.attr("disabled","disabled");var i={data:$xhttp2?new FormData($form[0]):$form.serialize(),url:$form.attr("action"),type:"post",success:function(){n.off("click"),location.reload()},error:function(t){$modal.trigger("clearform"),$btns.attr("disabled",!1),processAjaxErrors(t,$form)},beforeSend:function(){$modal.trigger("clearform")}};$xhttp2&&(i.cache=!1,i.contentType=!1,i.processData=!1,i.mimeType="multipart/form-data"),t.ajax(i)}),$modal.on("submit","form",function(a){var e=t(this).find('button,input[type="button"],input[type="submit"]').first();"submit-modal"==e.data("type")&&(a.preventDefault(),a.stopPropagation(),e.trigger("click"))})}(jQuery),function(t){function a(a,o,r){if(o.data("oldValue")!=r.val()){var n=o.data("editType");r.off("blur").off("change").off("keypress");var i="#text",l=t([]);o.data("textFormat")&&(l=t('[data-type="data-text-format"][data-name="'+o.data("textFormat")+'"]'),l.length>0&&(i=l.html().trim()));var d=r.val(),s=d;if("toggle"==n){var s=d?"Yes":"No";if(o.data("toggleTemplate")){var c=t('[data-type="data-toggle-template"][data-toggle-id="'+o.data("toggleTemplate")+'"][data-value="'+d+'"]');c.length>0&&(s=c.html().trim(),i="#text")}}else"select"==n&&(s=r.find('option[value="'+d+'"]').text());var f={text:s,value:d};if(o.data("config"))f=e(o.data("config"),d,s);else if(l.length>0&&l.data("config"))f=e(l.data("config"),d,s);else if("select"==n){var u=t('[data-type="data-select-source"][data-select-name="'+o.data("editSource")+'"]');u.data("config")&&(f=e(u.data("config"),d,s))}o.data("value",String(f.value)),s=i;for(var m in f)s=s.replace(new RegExp("#"+m,"g"),f[m]);"textarea"==n?o.html(s.replace(new RegExp("\n","g"),"<br>")):o.html(s),t.ajax({data:t.param({field:o.data("controlName"),value:d}),url:o.data("editUrl"),type:"post",complete:function(){o.data("oldValue",null).data("oldText",null)},error:function(t){o.data("value",o.data("oldValue")),o.html(o.data("oldText")),processAjaxErrors(t)}})}else o.data("oldValue",null).data("oldText",null);r.remove(),o.show()}function e(t,a,e){"object"!=typeof t&&(t={});var o={text:{},value:{}};o.text[a]=e,o.value[a]=a;for(var r in t)o[r]=t[r];var n={};for(var r in o)n[r]="undefined"!=typeof o[r][a]?o[r][a]:"text"==r?e:a;return n}t("body").on("click","[data-submit-ajax]",function(){var a=t(this);if(!a.data("submitConfirm")||confirm(a.data("submitConfirm"))){var e=a.data("submitAjax"),o=a.data(),r=a.data("successUrl")?a.data("successUrl"):window.location;delete o.submitAjax,delete o.submitConfirm,delete o.successUrl,a.attr("disabled","disabled"),t.ajax({data:t.param(o),url:e,type:"post",success:function(){window.location=r},error:function(t){a.attr("disabled",!1),processAjaxErrors(t)}})}}),t("body").on("click","[data-editable][data-edit-type]",function(e){var o,r=t(this),n=r.data("editType");e.preventDefault(),e.stopPropagation();var i,l;if("text"==n||"textarea"==n){var d=r.data();i=void 0!==d.value?r.data("value"):""==n?r.text():r.html(),l="text"==n?r.text():r.html()}else"toggle"==n?(i=r.data("value")&&"false"!=r.data("value"),l=r.html(),console.log("Raw: "+r.data("value")),console.log("Parsed: "+String(i))):"select"==n&&(i=r.data("value"),l=r.text());if(i="string"==typeof i?i.trim():i,l=l.trim(),r.data("oldValue",i).data("oldText",l),"text"==n)o=t('<input type="text" value="'+i+'">');else if("textarea"==n)o=t('<textarea rows="4">'+i.replace(new RegExp("\n","g"),"").replace(new RegExp("<br>","g"),"\n").replace(/<.*?>/g,"")+"</textarea>");else if("select"==n){var s=t('[data-type="data-select-source"][data-select-name="'+r.data("editSource")+'"]');if(0==s.length)return void console.log("No source found for control '"+r.data("controlName")+"'");o=t(s.html()).val(r.data("value"))}else{if("toggle"!=n)return;o=t('<input type="hidden" value="'+!i+'">')}o.insertAfter(r).attr("class","form-control").attr("name",r.data("controlName")).focus(),r.hide(),"toggle"==n?a(e,r,o):(o.on("blur",function(t){a(t,r,o)}),"text"==n||"textarea"==n?o.on("keypress",function(t){13!=t.which||!t.shiftKey&&"text"!=n||(t.preventDefault(),t.stopPropagation(),a(t,r,o))}):"select"==n&&o.on("change",function(){a(e,r,o)}))})}(jQuery),$.ajaxSetup({headers:{"X-XSRF-TOKEN":$('meta[name="xsrf-token"]').attr("content")},method:"GET",dataType:"json"}),$("select[select2]").each(function(){$(this).select2({placeholder:$(this).attr("select2")||"",theme:"bootstrap"})}),$('[data-type="filter-select"]').on("change",function(){var t=$(this);window.location=t.data("urlBase")+(t.val()?"/filter/"+t.val():"")}),$('[data-type="search-input"]').on("keypress",function(t){if(13==t.which){var a=$(this),e=encodeURI(a.val()).trim();window.location=a.data("urlBase")+(e?"/search/"+e:"")}}),$('input[data-input-type="datetimepicker"]').each(function(t,a){datetimepicker($(a))}),$('[data-type="toggle-visibility"]').on("change",function(){var t=$(this.form);t.find("[data-visibility-id]").addClass("hidden"),t.find('[data-visibility-id="'+$(this).val()+'"]').removeClass("hidden")});